<!--  IHE PCC Pregnancy Observation: 1.3.6.1.4.1.19376.1.5.3.1.4.13.5 -->

<!-- errors -->

  <pattern id="p-1.3.6.1.4.1.19376.1.5.3.1.4.13.5-errors">
    <title>IHE PCC Pregnancy Observation - errors validation phase</title>
    <rule context="*[cda:templateId/@root=&quot;1.3.6.1.4.1.19376.1.5.3.1.4.13.5&quot;]">
    <assert test='cda:templateId[@root="1.3.6.1.4.1.19376.1.5.3.1.4.13"]'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the parent template Id 
       (1.3.6.1.4.1.19376.1.5.3.1.4.13) of Pregnancy Observation shall exist.
    </assert>

    <assert test='cda:code[@codeSystem="2.16.840.1.113883.6.1"]'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), a Pregnancy Observation shall have a LOINC 
       code describing what facet of patient's pregnancy history is being recorded.
    </assert>

    <assert test='not(cda:code[@code="11449-6"]) or 
                  (cda:code[@code="11449-6"] and
                   cda:value[@xsi:type="CE"])'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the Pregnancy Observation with a LOINC code 
       of 11449-6 shall be recorded using a CE datatype.
    </assert>
    <assert test='not(cda:code[@code="8678-5"]) or
                  (cda:code[@code="8678-5"] and
                   cda:value[@xsi:type="CE"])'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the Pregnancy Observation with a LOINC code 
       of 8678-5 shall be recorded using a CE datatype.
    </assert>
    <assert test='not(cda:code[@code="8665-2"]) or
                  (cda:code[@code="8665-2"] and
                   cda:value[@xsi:type="TS"])'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the Pregnancy Observation with a LOINC code 
       of 8665-2 shall be recorded using a TS datatype.
    </assert>
    <assert test='not(cda:code[@code="11636-8"]) or
                  (cda:code[@code="11636-8"] and
                   (cda:value[@xsi:type="QTY"] or
                    cda:value[@xsi:type="INT"] or
                    cda:value[@xsi:type="MO"] or
                    cda:value[@xsi:type="TS"] or
                    cda:value[@xsi:type="REAL"] or
                    cda:value[@xsi:type="PQ"] or
                    cda:value[@xsi:type="RTO"]))'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the Pregnancy Observation with a LOINC code 
       of 11636-8 shall be recorded using a QTY datatype.
    </assert>
    <assert test='not(cda:code[@code="11637-6"]) or
                  (cda:code[@code="11637-6"] and
                   (cda:value[@xsi:type="QTY"] or
                    cda:value[@xsi:type="INT"] or
                    cda:value[@xsi:type="MO"] or
                    cda:value[@xsi:type="TS"] or
                    cda:value[@xsi:type="REAL"] or
                    cda:value[@xsi:type="PQ"] or
                    cda:value[@xsi:type="RTO"]))'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the Pregnancy Observation with a LOINC code 
       of 11637-6 shall be recorded using a QTY datatype.
    </assert>
    <assert test='not(cda:code[@code="11638-4"]) or
                  (cda:code[@code="11638-4"] and
                   (cda:value[@xsi:type="QTY"] or
                    cda:value[@xsi:type="INT"] or
                    cda:value[@xsi:type="MO"] or
                    cda:value[@xsi:type="TS"] or
                    cda:value[@xsi:type="REAL"] or
                    cda:value[@xsi:type="PQ"] or
                    cda:value[@xsi:type="RTO"]))'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the Pregnancy Observation with a LOINC code 
       of 11638-4 shall be recorded using a QTY datatype.
    </assert>
    <assert test='not(cda:code[@code="11639-2"]) or
                  (cda:code[@code="11639-2"] and
                   (cda:value[@xsi:type="QTY"] or
                    cda:value[@xsi:type="INT"] or
                    cda:value[@xsi:type="MO"] or
                    cda:value[@xsi:type="TS"] or
                    cda:value[@xsi:type="REAL"] or
                    cda:value[@xsi:type="PQ"] or
                    cda:value[@xsi:type="RTO"]))'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the Pregnancy Observation with a LOINC code 
       of 11639-2 shall be recorded using a QTY datatype.
    </assert>
    <assert test='not(cda:code[@code="11640-0"]) or
                  (cda:code[@code="11640-0"] and
                   (cda:value[@xsi:type="QTY"] or
                    cda:value[@xsi:type="INT"] or
                    cda:value[@xsi:type="MO"] or
                    cda:value[@xsi:type="TS"] or
                    cda:value[@xsi:type="REAL"] or
                    cda:value[@xsi:type="PQ"] or
                    cda:value[@xsi:type="RTO"]))'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the Pregnancy Observation with a LOINC code 
       of 11640-0 shall be recorded using a QTY datatype.
    </assert>
    <assert test='not(cda:code[@code="11778-8"]) or
                  (cda:code[@code="11778-8"] and
                   cda:value[@xsi:type="TS"])'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the Pregnancy Observation with a LOINC code 
       of 11778-8 shall be recorded using a TS datatype.
    </assert>
    <assert test='not(cda:code[@code="11779-6"]) or
                  (cda:code[@code="11779-6"] and
                   cda:value[@xsi:type="TS"])'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the Pregnancy Observation with a LOINC code 
       of 11779-6 shall be recorded using a TS datatype.
    </assert>
    <assert test='not(cda:code[@code="11780-4"]) or
                  (cda:code[@code="11780-4"] and
                   cda:value[@xsi:type="TS"])'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the Pregnancy Observation with a LOINC code 
       of 11780-4 shall be recorded using a TS datatype.
    </assert>
    <assert test='not(cda:code[@code="11884-4"]) or
                  (cda:code[@code="11884-4"] and
                   cda:value[@xsi:type="PQ"])'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the Pregnancy Observation with a LOINC code 
       of 11884-4 shall be recorded using a PQ datatype.
    </assert>
    <assert test='not(cda:code[@code="11885-1"]) or
                  (cda:code[@code="11885-1"] and
                   cda:value[@xsi:type="PQ"])'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the Pregnancy Observation with a LOINC code 
       of 11885-1 shall be recorded using a PQ datatype.
    </assert>
    <assert test='not(cda:code[@code="11886-9"]) or
                  (cda:code[@code="11886-9"] and
                   cda:value[@xsi:type="PQ"])'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the Pregnancy Observation with a LOINC code 
       of 11886-9 shall be recorded using a PQ datatype.
    </assert>
    <assert test='not(cda:code[@code="11887-7"]) or
                  (cda:code[@code="11887-7"] and
                   cda:value[@xsi:type="PQ"])'>
       Error: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the Pregnancy Observation with a LOINC code 
       of 11887-7 shall be recorded using a PQ datatype.
    </assert>

    </rule>
  </pattern>

  <!-- warning -->

  <pattern id="p-1.3.6.1.4.1.19376.1.5.3.1.4.13.5-warnings">
    <title>IHE PCC Pregnancy Observation - warning validation phase</title>


    <rule context="*[cda:templateId/@root=&quot;1.3.6.1.4.1.19376.1.5.3.1.4.13.5&quot;]">
      <assert test='cda:code[@code = "11449-6" or
                             @code = "8678-5" or                             
                             @code = "8665-2" or
                             @code = "11636-8" or
                             @code = "11637-6" or
                             @code = "11638-4" or
                             @code = "11639-2" or
                             @code = "11640-0" or
                             @code = "11778-8" or
                             @code = "11779-6" or
                             @code = "11780-4" or
                             @code = "11884-4" or
                             @code = "11885-1" or
                             @code = "11886-9" or
                             @code = "11887-7"]'>
         Warning: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), a pregnancy observation shall have a 
         LOINC code describing what facet of patient's pregnancy history is being recorded. These codes should come from the 
         list ( see http://wiki.ihe.net/index.php?title=1.3.6.1.4.1.19376.1.5.3.1.4.13.5 ). Additional codes may be used to
         reflect additional information about the pregnancy history.
      </assert>

      <report test='cda:repeatNumber'>
         Warning: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the &lt;repeatNumber&gt; element should 
         not be present.
      </report>

      <report test='cda:interpretationCode or cda:methodCode or cda:targetSiteCode'>
         Warning: In IHE PCC Pregnancy Observation (1.3.6.1.4.1.19376.1.5.3.1.4.13.5), the &lt;interpretationCode&gt;, 
         &lt;methodCode&gt;, and &lt;targetSiteCode&gt; should not be present.
      </report>
    </rule>


  </pattern>
